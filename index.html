<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Cash Register</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div class="calculator">
      <table>
        <tr>
          <div class="display" id="display">
            <input
              type="text"
              name="calulatorText"
              id="calulatorText"
              disabled
            />
          </div>
        </tr>
        <tr>
          <td>
            <button class="clearBtn" onclick="clearDisplay()">Clear</button>
          </td>
          <td></td>
          <td><button class="changer" onclick="hufToEur()">HUF to EUR</button></td>
          <td><button class="changer" onclick="eurToHuf()">EUR to HUF</button></td>
        </tr>
        <tr>
          <td><button onclick="appendNumber(7)">7</button></td>
          <td><button onclick="appendNumber(8)">8</button></td>
          <td><button onclick="appendNumber(9)">9</button></td>
          <td><button onclick="calculatePercentage()">%</button></td>
        </tr>
        <tr>
          <td><button onclick="appendNumber(4)">4</button></td>
          <td><button onclick="appendNumber(5)">5</button></td>
          <td><button onclick="appendNumber(6)">6</button></td>
          <td><button onclick="appendOperator('*')">*</button></td>
        </tr>
        <tr>
          <td><button onclick="appendNumber(1)">1</button></td>
          <td><button onclick="appendNumber(2)">2</button></td>
          <td><button onclick="appendNumber(3)">3</button></td>
          <td><button onclick="appendOperator('-')">-</button></td>
        </tr>
        <tr>
          <td><button onclick="appendNumber(0)">0</button></td>
          <td><button onclick="appendNumber('.')">,</button></td>
          <td><button onclick="calculateResult()">=</button></td>
          <td><button onclick="appendOperator('+')">+</button></td>
        </tr>
        <tr>
          <td>
            <button class="endDay" onclick="toggleBusinessHours()">
              END DAY
            </button>
          </td>
        </tr>
      </table>
    </div>

    <script>
      let display = document.getElementById("display");
      let calculation = "";
      let eredmeny = 0;

      function appendNumber(number) {
        calculation += number;
        display.textContent = calculation;
      }

      function appendOperator(operator) {
        if (calculation === "") return;
        calculation += operator;
        display.textContent = calculation;
      }

      function clearDisplay() {
        calculation = "";
        display.textContent = "";
      }

      function calculateResult() {
        try {
          display.textContent = eval(calculation);
          eredmeny = eval(calculation);
          calculation = "";
        } catch (error) {
          display.textContent = "Error";
        }
      }

      function calculatePercentage() {
        if (calculation === "") return;
        //megkeresi az utolsó operátort
        let lastOperatorIndex = calculation.lastIndexOf("+");
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("-")
        );
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("*")
        );
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("/")
        );
        //ha nincs nem csinál semmit
        if (lastOperatorIndex === -1) return;
        //kivágja az első számot
        const firstNumber = calculation.substring(lastOperatorIndex + 1);
        //kiszámolja a százalék értéket
        const percentageValue = parseFloat(firstNumber) / 100;
        //kivonja a százalékot az első értékből
        const result =
          parseFloat(calculation) - percentageValue * parseFloat(calculation);
        //megjeleniti az eredményt
        display.textContent = result;
        calculation = result.toString();
      }

      function hufToEur(){
          eredmeny = (eredmeny / 389).toFixed(2);
          display.textContent = eredmeny.toString();
      } 
      function eurToHuf(){
        eredmeny = (eredmeny * 389);
        display.textContent = eredmeny.toString();
       
      }

      function toggleBusinessHours() {}
    </script>
  </body>
</html>
