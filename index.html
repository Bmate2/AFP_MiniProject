<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simple Cash Register</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <div class="calculator">
      <table>
        <tr>
          <div class="display" id="display">
            <input
              type="text"
              name="calulatorText"
              id="calulatorText"
              disabled
            />
          </div>
        </tr>
        <tr>
          <td>
            <button  class="disable"  onclick="clearDisplay()">Clear</button>
            <td>
              <button  class="disable"  onclick="">Receipt</button>
            </td>
          </td>
          <td></td>
          <td><button class="disable" class="changer"  onclick="hufToEur()">HUF to EUR</button></td>
          <td><button class="disable" class="changer"  onclick="eurToHuf()">EUR to HUF</button></td>
        </tr>
        <tr>
          <td><button class="disable" onclick="appendNumber(7)">7</button></td>
          <td><button class="disable" onclick="appendNumber(8)">8</button></td>
          <td><button class="disable" onclick="appendNumber(9)">9</button></td>
          <td><button class="disable" onclick="calculatePercentage()">%</button></td>
        </tr>
        <tr>
          <td><button class="disable" onclick="appendNumber(4)">4</button></td>
          <td><button class="disable" onclick="appendNumber(5)">5</button></td>
          <td><button class="disable" onclick="appendNumber(6)">6</button></td>
          <td><button class="disable" onclick="appendOperator('*')">*</button></td>
        </tr>
        <tr>
          <td><button class="disable" onclick="appendNumber(1)">1</button></td>
          <td><button class="disable" onclick="appendNumber(2)">2</button></td>
          <td><button class="disable" onclick="appendNumber(3)">3</button></td>
          <td><button class="disable" onclick="appendOperator('-')">-</button></td>
        </tr>
        <tr>
          <td><button class="disable" onclick="appendNumber(0)">0</button></td>
          <td><button class="disable" onclick="appendNumber('.')">,</button></td>
          <td><button class="disable" onclick="calculateResult()">=</button></td>
          <td><button class="disable" onclick="appendOperator('+')">+</button></td>
        </tr>
        <tr>
          <td>
            <button class="oDay" id="openButton" onclick="openDay()">
              OPEN
            </button>          
          <button  hidden class="cDay" id="closeButton" onclick="closeDay()">
            CLOSE
          </button>
          </td>
        </tr>
      </table>
    </div>

    <script>
      let display = document.getElementById("display");
      let calculation = "";
      let eredmeny = 0;
      let isOpen = false;      //Az oldal betöltésekor nincs nyitva a kassza
      let dailyStartAmount = null; // A napi kezdőérték 0-ra állitása

      function appendNumber(number) {
        calculation += number;
        display.textContent = calculation;
      }

      function appendOperator(operator) {
        if (calculation === "") return;
        calculation += operator;
        display.textContent = calculation;
      }

      function clearDisplay() {
        calculation = "";
        display.textContent = "";
      }

      function calculateResult() {
        try {
          display.textContent = eval(calculation);
          eredmeny = eval(calculation);
          calculation = "";
        } catch (error) {
          display.textContent = "Error";
        }
      }

      function calculatePercentage() {
        if (calculation === "") return;
        //megkeresi az utolsó operátort
        let lastOperatorIndex = calculation.lastIndexOf("+");
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("-")
        );
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("*")
        );
        lastOperatorIndex = Math.max(
          lastOperatorIndex,
          calculation.lastIndexOf("/")
        );
        //ha nincs nem csinál semmit
        if (lastOperatorIndex === -1) return;
        //kivágja az első számot
        const firstNumber = calculation.substring(lastOperatorIndex + 1);
        //kiszámolja a százalék értéket
        const percentageValue = parseFloat(firstNumber) / 100;
        //kivonja a százalékot az első értékből
        const result =
          parseFloat(calculation) - percentageValue * parseFloat(calculation);
        //megjeleniti az eredményt
        display.textContent = result;
        calculation = result.toString();
      }

      function hufToEur(){
          eredmeny = (eredmeny / 389).toFixed(2);
          display.textContent = eredmeny.toString();
      } 
      function eurToHuf(){
        eredmeny = (eredmeny * 389);
        display.textContent = eredmeny.toString();
       
      }
      // gombok letiltása
      function disableButtons(className) {
        const buttons = document.querySelectorAll(`button.${className}`);
        buttons.forEach((button) => {
        button.disabled = true;
          });
      }

      // gombok aktiválása
      function enableButtons(className) {
         const buttons = document.querySelectorAll(`button.${className}`);
         buttons.forEach((button) => {
         button.disabled = false;
            });
      }

       // betöltéskor gombok letiltása
       disableButtons("disable");
       disableButtons("clearBtn");
 

       

    </script>
  </body>
</html>
